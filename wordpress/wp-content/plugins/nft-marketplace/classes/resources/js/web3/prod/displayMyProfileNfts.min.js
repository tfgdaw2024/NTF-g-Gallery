jQuery(document).ready(async function(){let t=async()=>{await connectWallet(jQuery("#monft-mp-connect-wallet"))};async function e(){let t=await window.ethereum.request({method:"eth_requestAccounts"});owns_nft=!1;let e=[];for(collection_name in mo_nft_collection){var n=mo_nft_collection[collection_name].contractAddress,a=mo_nft_collection[collection_name].contractABI;let s=mo_nft_collection[collection_name].blockchain,o=mo_nft_collection[collection_name].customTokenName,d=[],l=[],r=(l=getChainDetails(s,o)).url,m=new Web3(r),f=new m.eth.Contract(JSON.parse(a),n);signer=(provider=new _ethers.providers.Web3Provider(window.ethereum)).getSigner(),balance=Number(await f.methods.balanceOf(t[0]).call());for(var c=0;c<balance;c++){let h=await f.methods.tokenOfOwnerByIndex(t[0],c).call(),g=await f.methods.tokenURI(h).call();d.push({tokenId:h,tokenURI:g}),owns_nft=!0}for(var c=0;c<d.length;c++){let u=d[c];if(u.tokenURI.includes("https://ipfs.io/ipfs/")){let p=u.tokenURI.lastIndexOf("/"),v=u.tokenURI.substr(p+1);metadataRes=await fetch(`https://cloudflare-ipfs.com/ipfs/${v}`)}else metadataRes=await fetch(`https://cloudflare-ipfs.com/ipfs/${u.tokenURI}`);let $=await metadataRes.json();u.metadata=$,nfthtml='<div class="monft-nft-grid-item" id="mo-nft-product-'+u.tokenId+'">',nfthtml+='<div class="monft-image-wrapper-minted">',nfthtml+=`<img src ="https://cloudflare-ipfs.com/ipfs/${u.metadata.image.substr(7)}" class="monft_image" name="monft_image" id="monft_image_`+u.tokenId+'"/>',nfthtml+="</div>",nfthtml+='<div class="monft-grid-info-panel" id="monft-grid-info-panel-'+u.tokenId+'">',nfthtml+='<h3 class="monft-item-name">'+u.metadata.name+" #"+u.tokenId+"</h3>",nfthtml+='<div class="monft-attributes" hidden>',nfthtml+='<input id="'+u.tokenId+'collection_name"value="'+collection_name+'" hidden>';let w="";for(let b in u.metadata.attributes){let _=u.metadata.attributes[b].trait_type,y=u.metadata.attributes[b].value;(void 0==e[_]&&""!=_||void 0!=_)&&(e[_]=[]),e[_][y]=1,w+=_+y,nfthtml+='<p class="monft_attribute_title" id="'+b+'">',nfthtml+=_+": "+y+"</p>"}if(nfthtml+="</div>",nfthtml+='<label for="listingPrice"></label>',void 0==monft_listed_nft_order_ids[u.tokenId])w+="monftnotlisted",nfthtml+='<p id="monft-is-listed-message-'+u.tokenId+'" class="monft-is-listed-message monft_listed_price" id="monft_listed_price_0">Not Listed</p>',nfthtml+='<div style="display:flex;" name="listing_details_'+u.tokenId+'"><input type="text" id="trade_nft_details_'+u.tokenId+'" name="tradingAddress" class="monft-trade-nft-address-text" placeholder="Enter Receiver Address">',nfthtml+='<button class="trade-button" name="trade-button" id='+u.tokenId+' class="btn" > Trade NFT </button>',nfthtml+="</div>",nfthtml+="</div>";else{w+="monftlisted",nfthtml+='<p id="monft-is-listed-message-'+u.tokenId+'" class="monft-is-listed-message" >Listed</p>';let k=_ethers.utils.formatEther(monft_listed_nft_order_ids[u.tokenId]);nfthtml+='<p id="monft_listed_price_'+k+'" class="monft_listed_price monft-is-listed-message">Price: '+k+" "+l.chainSymbol+"</p>"}nfthtml+='<div id="monft_metadata_'+u.tokenId+'" class="monft_metadata" hidden>'+w+"</div>",displayCategories(e),jQuery(".monft-nft-grid").append(nfthtml)}}jQuery("#loaderwholescreenprofile").hide(),owns_nft||(jQuery("#loaderwholescreenprofile").hide(),jQuery(".monft_empty_profile_message").show(),jQuery(".monft_categories").empty()),function t(e){if(e){function n(){if(filterCount>0)for(j=0,AttributesCheckboxList=jQuery(".filter"),productsMetadataList=jQuery(".monft_metadata");j<productsMetadataList.length;j++)for(jQuery("#mo-nft-product-"+(productID=(productID=productsMetadataList[j].getAttribute("id")).substring(15))).hide(),i=0;i<AttributesCheckboxList.length;i++)id=AttributesCheckboxList[i].getAttribute("id"),!0==AttributesCheckboxList[i].checked&&-1!=(productMetadata=productsMetadataList[j].innerHTML).indexOf(id)&&jQuery("#mo-nft-product-"+productID).show();else jQuery(".monft-nft-grid-item").show()}jQuery('svg[name="display-category-metadata-icon"]').click(async function(){id=jQuery(this).attr("id"),jQuery('div[name="'+id+'"]').is(":visible"),jQuery('div[name="'+id+'"]').slideToggle()}),jQuery('svg[name="monft_filter_attributes"]').click(async function(){jQuery(".monft-filter-list").is(":visible")?(document.getElementById("monft_filter_attributes").classList.toggle("rotate180"),jQuery(".monft-filter-list").hide()):jQuery(".monft-filter-list").show()}),filterCount=0,jQuery(".filter").change(function(){!0==jQuery(this)[0].checked?filterCount+=1:filterCount-=1,n()}),jQuery("#PriceLowToHigh").change(function(){let t;(t=jQuery(".monft-nft-grid-item")).sort(function(t,e){return(priceA=(productIdA=jQuery(t).find(".monft_listed_price")[0].getAttribute("id")).substring(20))-(priceB=(productIdB=jQuery(e).find(".monft_listed_price")[0].getAttribute("id")).substring(20))}),jQuery(".monft-nft-grid").html(t),n()}),jQuery('button[name="trade-button"]').click(async function(){let t=jQuery(this).attr("id"),e=jQuery("#"+t+"collection_name").val();jQuery('img[name="listing_loader_'+t+'"]').show();var n=jQuery("#trade_nft_details_"+t).val(),a=mo_nft_collection[e].contractAddress,s=mo_nft_collection[e].contractABI;let o=new _ethers.Contract(a,s),d=new _ethers.providers.Web3Provider(window.ethereum),l=d.getSigner();try{let r=await window.ethereum.request({method:"eth_requestAccounts"}),m=await o.connect(l).transferFrom(r[0],n,t);await m.wait(1);await jQuery.post(ajaxurl,{action:"monft_moralis_get_data",request:"monft_save_owner_after_trade",txHash:m.hash,tokenId:t,mo_nft_verify_nonce:wpNonce},async function(t){}),jQuery('img[name="listing_loader_'+t+'"]').hide(),jQuery('div[name="trade_nft_details_'+t+'"]').hide(),jQuery('p[name="trade_message_'+t+'"]').show()}catch(f){throw 4001===f.code&&jQuery('img[name="listing_loader_'+t+'"]').hide(),f}})}}(owns_nft)}void 0!==window.ethereum&&window.ethereum.request({method:"eth_accounts"}).then(t=>{0!==t.length&&jQuery("#monft-mp-connect-wallet").text("Wallet connected: "+t[0].substring(0,5)+"...."+t[0].substring(37,42))}).catch(t=>{console.log(t,t.code)}),void 0!==monft_listed_nft_order_ids&&(jQuery("#loaderwholescreenprofile").show(),await e()),jQuery("#monft-mp-connect-wallet").click(t);let n=async()=>{let t=jQuery(".monft-sub-navbar-search-profile"),e=jQuery(".monft-nft-grid-item");searchNft(t,e)};jQuery(".monft-sub-navbar-search-profile").on("input",n)});function displayCategories(t){let e="";for(let n in e+='<h5 style="margin-left: 11%; color:red;"> <b> ATTRIBUTES </b> </h5>',t)if(""!==n){for(let a in e+='<div class="monft-filter-list-item"><h4>'+n+' </h4><svg id="monft_category_properties_'+n+'" class="monft-filter-down-arrow" name="display-category-metadata-icon" width="26" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.9991 14.1685L17.9506 9.21994L19.3641 10.6344L12.9983 16.9965L6.63615 10.6307L8.05156 9.21708L13.0001 14.1685L12.9991 14.1685Z" fill="#303030"/></svg></div>',e+='<div name="monft_category_properties_'+n+'" hidden >',t[n])e+='<div class="monft_category_value" style="margin-left: 13%; font-size: medium;">'+a+'<input class="filter" type="checkbox" id="'+n.toString()+a.toString()+'" /></div>';e+="</div>",e+="<hr></div>"}e+='<hr style="width:100%"></hr>',e+='<h5 style="margin-left:11%; color:red;"> <b> STATUS </b> </h5>',e+='<div style="margin-left:11%;" class="monft_status_value">Listed<input class="filter" type="checkbox" id="monftlisted" /></div>',e+='<div style="margin-left:11%;" class="monft_status_value">Not Listed<input class="filter" type="checkbox" id="monftnotlisted" /></div>',jQuery(".monft-filter-list").empty(),jQuery(".monft-filter-list").append(e)}